/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class TextToSpeech{static _contructor(){this._isInitialized||(this._isPlaying=!1,this._isInitialized=!0)}static supportsLanguage(e){return["de","en","es","fr","it","nl","pl","pt","ru"].includes(e.toLowerCase().substr(0,2))}static supportsWord(e){return!["languagetool"].includes(e.toLowerCase())}static _getVoices(e){this.isSupported()&&(window.speechSynthesis.getVoices().length?e(window.speechSynthesis.getVoices()):speechSynthesis.onvoiceschanged=function(){e(window.speechSynthesis.getVoices())})}static _findVoice(e,t){let s=t.toLowerCase();"en-au"!==s&&"en-nz"!==s||(s="en-gb");for(const t of e)if(t.lang.toLowerCase()===s&&t.name.toLowerCase().indexOf("google")>-1)return t;s=s.substr(0,2);for(const t of e)if(t.lang.substr(0,2).toLowerCase()===s&&t.name.toLowerCase().indexOf("google")>-1)return t;for(const t of e)if(t.lang.substr(0,2).toLowerCase()===s)return t;return null}static _createUtterance(e,t,s=!1,i,n){const o=new SpeechSynthesisUtterance;o.voice=t,o.text=e,o.lang=i,o.rate=.8;const r=this;return s&&o.addEventListener("end",function(){r.stop(),n()}),o.addEventListener("error",function(){r.stop(),n()}),o}static playMany(e,t,s,i=500){const n=[...e],o=()=>{const e=n.shift();e?this.play(e,t,()=>{setTimeout(o,i)}):s()};o()}static play(e,t,s){this._getVoices(i=>{const n=this._findVoice(i,t);if(this._isPlaying=!0,n){const i=this._createUtterance(e,n,!0,t,s);speechSynthesis.speak(i),Tracker.trackEvent("Action","speak_word")}})}static stop(){this._isPlaying=!1,speechSynthesis.cancel()}static isSupported(){return window.speechSynthesis&&window.speechSynthesis.getVoices&&BrowserDetector.isChrome()&&!navigator.userAgent.includes("Chromium")}static isPlaying(){return this._isPlaying}}TextToSpeech._isInitialized=!1,TextToSpeech._contructor();